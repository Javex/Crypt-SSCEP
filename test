#!/root/perl5/perlbrew/perls/perl-5.16.2/bin/perl
use ExtUtils::testlib;
use test2;

my $key = "
-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCr6E0K6ZGJtMDG
oZlqhvCTBswop02oJ/EeQZTElNmY9iHCcjfIUMe1WgsurhGBH9fqFWLdRlsyDxzM
cIhBpf7nG4R6zeeecXswSq/NC5yUHVStyD5Hwf5LMkIgIw05JcdjZwqw/b7Vkrw7
oe2Uk4UQWlPuVFCkuLJZ5n6W2b2OMv89gJ5e1UdtjG2aH9wKv9WZ575us3rT1hbi
8JAGusUxQKFsekyiNfy54xItqgx9Gcw1odY4OfeiX0P6ARoXOFvlYCAn2wkeE6hn
j1n26nU+LSfwU7CzMWhGbyngB53wToNIP/q3RreTqO9SunD1qNKWzx8AYc7cgfja
kdlh4mR7AgMBAAECggEAR3keDxttV0O/otYtYw0XmQmKeJyWvQNeTKYXpGP+1IoB
H0c9yhtL7Sqy24Wj4XvL2Zdqs3U9FWMTJizjeef6Qzw9qJFTa5zjCwECds4NG8fW
HSrUOiF+COWseJAaP1hlvf5pg4z8eu+3M1Pv44YyHMpxevWzUck43gfnOfDtzuDW
FPOgwB7GtOa5SdrE2hURLFbk0Au7xRSNYkqR3+HJ43raBkUr+IAZY/83nqAAfJxh
BJjTFv5ECXjnATiXqqDhZKuKCkr9oTr6i38DFuDowB/0QaBo1H6eneGTOPgSFXaR
R1mETzzyZMaDPHwM3n9193aEWU+aaWxCf2Jguq4UgQKBgQDj0yKTr0tdQfZwS3EY
mh1eemcZ7/cEJL637gVoKHpzy00ROv+T+ImWg9kkEh8e1KmjP7aDhFKGyXA2EEEO
fSnCeMxIvTLAelKMt6hDmEbl2VjHr2bTVt2XMhOxwxJt3BJSawuHDd+Js5454awu
1lvV5aMCp3gXO2Ashinv/vSbPwKBgQDBKtb/hs4/XmtQlLHur/pMawoG5DL1GRDi
RlGjCOiWf0+8E7kVlZEsTFslS+AE/WZpSihuqh7ObQfaaFNtu3+t91q7GeL8T6SW
I7Y+5ss/toYEPbmBnhlP1au7NVqzyP4LTYuHkorKWF3pk1YGWE6/vwj5eVh4aLK/
cV9Xmc7TxQKBgHng1bqUKIk3ZJMmiNZUfCmy6b0ids8sqSrUlufl37xaolv5aAjN
CS4QUvXNDAD+W9INn6I0A8I/uVvyzhrmMpTq8r5nGOOHjOnixo2CxUrpP2l0GFov
OlRMYeTTKuTCurqEsaIKde/Au4DTjb1wx6hiNRaSaNhk10p6a60Mg+cZAoGBAK+O
abvuHoBFJa8klNnjIc5V8dT1jMJot4mOcx+DNy+gIS1Dl5DgUAI8mxG4da7TRkIm
3bxF7J2bRenfqwMtxwqqpdEp47t//otdhYKBavNKxV4RYwlEUKjX/q2z/e0rnIdV
QJxEONNRoHhqKWK220s1Kcjh2eAE9386YHZTGUApAoGAPJGQoYFXwv6PNOTBP/oN
6uH9tcbvjWNGfrLANdhwrXU6ZNvAjjcRMNV/Yh4CeoCOpBt9+7Vk10gjTyzkd+2P
ORNMim46r8wcsZSz/2oYLufjS8IdIbyui1o/VmikcfV8sMuzMOk9mbM/o3cHOlQH
uDcUGE13IBGcdf4hGQ31f9Y=
-----END PRIVATE KEY-----
";

my $cert = "
-----BEGIN CERTIFICATE-----
MIIFvTCCBKWgAwIBAgIBADANBgkqhkiG9w0BAQQFADBxMQswCQYDVQQGEwJJVDEY
MBYGA1UEChMPSGFja21hc3RlcnMubmV0MSAwHgYDVQQDExdDZXJ0aWZpY2F0aW9u
IEF1dGhvcml0eTEmMCQGCSqGSIb3DQEJARYXc3VwcG9ydEBoYWNrbWFzdGVycy5u
ZXQwHhcNMDIxMDE3MTA1NzE4WhcNMDQxMjI1MTA1NzE4WjBxMQswCQYDVQQGEwJJ
VDEYMBYGA1UEChMPSGFja21hc3RlcnMubmV0MSAwHgYDVQQDExdDZXJ0aWZpY2F0
aW9uIEF1dGhvcml0eTEmMCQGCSqGSIb3DQEJARYXc3VwcG9ydEBoYWNrbWFzdGVy
cy5uZXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDA71mE9w5HRpd/
sXbsQyNXz4LtuP66TJa0vQdNFjzwq1FdHHHVhy9mp7Go8zThIXmhXoynfhf8+dPx
/w5gigX1j5bw1rBvLDkHsxhivnEHczxvPDkxay50bzz3RHmq52W2eX9m+P8HSaVH
wNxww4x/DW1kPqXXBo1Maf600dcIaW/TNkBgcVimf7+vrrPSThy7UR6GQMh1Q2GO
cJ28DzfJ0yvAqQnKKz1A/l3t69qRXmg7oUB1N/l75urfvNyux9T1oyYfgiNpDBGC
mBcESkEvxnnWJIEg1YVPPglGdSZ4yCW/eOYlf35Of+FsaXP/Tub2cZkGZmIAQgpK
BQxnFk55AgMBAAGjggJeMIICWjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBR4
6EyjnHHr4SPm6rwybpne+AOT0jCBmwYDVR0jBIGTMIGQgBR46EyjnHHr4SPm6rwy
bpne+AOT0qF1pHMwcTELMAkGA1UEBhMCSVQxGDAWBgNVBAoTD0hhY2ttYXN0ZXJz
Lm5ldDEgMB4GA1UEAxMXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxJjAkBgkqhkiG
9w0BCQEWF3N1cHBvcnRAaGFja21hc3RlcnMubmV0ggEAMAsGA1UdDwQEAwIBxjAi
BgNVHREEGzAZgRdzdXBwb3J0QGhhY2ttYXN0ZXJzLm5ldDAiBgNVHRIEGzAZgRdz
dXBwb3J0QGhhY2ttYXN0ZXJzLm5ldDARBglghkgBhvhCAQEEBAMCAAcwQgYJYIZI
AYb4QgENBDUWM0hhY2ttYXN0ZXJzLm5ldCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0
eSBDZXJ0aWZpY2F0ZTBKBgNVHR8EQzBBMD+gPaA7hjlodHRwczovL2dhbGFkcmll
bC5tcG5ldC5oYWNrbWFzdGVycy5uZXQvcHViL2NybC9jYWNybC5jcmwwSAYJYIZI
AYb4QgEEBDsWOWh0dHBzOi8vZ2FsYWRyaWVsLm1wbmV0LmhhY2ttYXN0ZXJzLm5l
dC9wdWIvY3JsL2NhY3JsLmNybDBIBglghkgBhvhCAQMEOxY5aHR0cHM6Ly9nYWxh
ZHJpZWwubXBuZXQuaGFja21hc3RlcnMubmV0L3B1Yi9jcmwvY2FjcmwuY3JsMA0G
CSqGSIb3DQEBBAUAA4IBAQAmp5PGnJLXqz7/81Bwn727L6VzeNCkZeFpJzJMnfmP
cIuHiG0BgD/Nlzfl9gIYlq/pn1KKr4Wpj+FMWyrdxUJfzqYN/qKKat+tWmxD0Mb0
yMncwnWIJtwxcKvHGdkJ7A1p+4THV0KOb42m9upZg4cbI77AEy7MqnEjeUat3AZZ
xFED20zY6kulIBHoypLeAI/0RAer8ssjfcb7Psz+1jsosX2+kNAuFZmsEzljiD/F
LtYgWDHT1g2a49jXUT5jAPhtT3fe6vZivSfDxuZ9Q/jGaRbiUPfUYJ25HYbx98rk
8e3t8vQNHsIslDPqN3hshlUezmnMB7mOPgHfn3AoAAyN
-----END CERTIFICATE-----
";

my $cacert = "
-----BEGIN CERTIFICATE-----
MIIFQjCCAyqgAwIBAgIJAOv1w5e0dwReMA0GCSqGSIb3DQEBBQUAMB8xCzAJBgNV
BAYTAkZPMRAwDgYDVQQIDAdHZXJtYW55MB4XDTE0MTIxNTIwMjkwNloXDTI0MTIx
MjIwMjkwNlowHzELMAkGA1UEBhMCRk8xEDAOBgNVBAgMB0dlcm1hbnkwggIiMA0G
CSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDiOfuRqc66x6qLi5+br8zFIjzKUWaN
pOcdyLE3JKJqWGHLqT23wly06XqiX6Zn7JHKHhyFC1pyCyEmcCnQ/K0wGlHlSlCO
b8PT0kflXTtAFg2GjUpVfKVkopOccwl2pZqfXo0sYZRP692N3l9/kEVPO1pWtEPw
fseWlkA3Z71Hnl/6Gcl2puxKdXr8MfHA25rrfoa4yr+rSnQhM7HkhSvGbGz146pM
LpC5NXYmeTv8nk9au4aG77MY0sEacWtxSez78xHiY/XyHKnXJdGjiB7aOc62V5ib
tqHAdvFPuui+0MRBuuOM1tMpBBsFdSZd8P4kaOlMalZ8QZIw9jfa0Fya8oThRA1R
gkmE5Vb9rznL8u+WvwOrboouXquKAG8FT+GDOiCXL3pqOcJdSnRwyGYdh/5rakGa
N1/pTHNAlLGqo5JE149jPfMfZw6h1ZX9G1iCQFfNEkrWTbAB393cRUsZbbUTRvs7
VliYOwgluDRSHXkYwsjzTT540kW2yspC+vI6lH8BswJgtciprqbnvFEoQKgFuKyE
DAo8m+ylvWev8VMDFQlb6A9L76EItMikyLPcdIAxnOvtFU3CHxWJN1d0k5S42uip
2VJ10nkoe2sH0npuhKq35n17RLB+eQamfNPS0xAZUSrDA4ddRYtf3Y8r2X6/IkhU
9/h/2tlUTJ9ciwIDAQABo4GAMH4wHQYDVR0OBBYEFDxBNF7lQjGJTApoyDwPin3w
MX9pME8GA1UdIwRIMEaAFDxBNF7lQjGJTApoyDwPin3wMX9poSOkITAfMQswCQYD
VQQGEwJGTzEQMA4GA1UECAwHR2VybWFueYIJAOv1w5e0dwReMAwGA1UdEwQFMAMB
Af8wDQYJKoZIhvcNAQEFBQADggIBAKr8t2fgm5KwLcz5riJgaZ6Glu5yx+lkOVMC
Fp3GPvc9xrWP2aiYBo9KZVGKiLht+o6hw52T8DzV0utzToRvrW0VLZFVlmZk8HRk
sdl7Lc/uEhXfHDeIB94euLRFTUH6GvVzOMUoua4ht2KVJoYn7qLlVZHBNydKpuZT
+7ucwcKSL0sIWX2aezShPM1F2Q+8s8tJV7zUg5kFMnXpqxyD0XMZSElhr9nFBG1E
1xJ056oW6Mkrlpd8eRZ0SZaXBpMUsf1JO4rPN3siF+iJMkShg+sTvMkLU3SNmeut
pYEDIyl5RZg/x35QNvUeym/eR+dRt47mcUP+zojmG9oIUnDgB3PxyFG0yvV0zy2D
1pxbSR2iaFBPL+KAlOV7u9NITaskrys6qoX4MbtYB7YkemvVweL0BEZHWAv96wY8
0rel9r1zRXWyybeTc3TvNJy8VlarBWcwWMLDGxrKaIEqQjcliIEhMoEMeICa7iZi
6WHXC4C8iW6IaxYs/ruCcfV1w2DYtqpAdD1wT+rc5sYfQPFI9YhG2WQGX9d4hV4F
Zilox4+09fQHRTqE7op9UjR9hkqvRg2rgJye+aYNg88oQYvzA2jLTAcoqmnSS8Ed
TZwlF/T9t3VUrvG2GAkKLkhAs0AnRWbHbrSHrUackdoMK8XQHVZObVgYSwoVvq6K
/8zAvYDs
-----END CERTIFICATE-----
";

my $req = "
-----BEGIN CERTIFICATE REQUEST-----
MIICgzCCAWsCAQAwPjELMAkGA1UEBhMCREUxDDAKBgNVBAgMA05SVzEhMB8GA1UE
CgwYSW50ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAq+hNCumRibTAxqGZaobwkwbMKKdNqCfxHkGUxJTZmPYhwnI3
yFDHtVoLLq4RgR/X6hVi3UZbMg8czHCIQaX+5xuEes3nnnF7MEqvzQuclB1Urcg+
R8H+SzJCICMNOSXHY2cKsP2+1ZK8O6HtlJOFEFpT7lRQpLiyWeZ+ltm9jjL/PYCe
XtVHbYxtmh/cCr/Vmee+brN609YW4vCQBrrFMUChbHpMojX8ueMSLaoMfRnMNaHW
ODn3ol9D+gEaFzhb5WAgJ9sJHhOoZ49Z9up1Pi0n8FOwszFoRm8p4Aed8E6DSD/6
t0a3k6jvUrpw9ajSls8fAGHO3IH42pHZYeJkewIDAQABoAAwDQYJKoZIhvcNAQEF
BQADggEBADBiuojDaTHTiVMhDaiImuBvsIMwnb2RaOaJXKHkXy5cn1mVzzBrJTQO
0RVPOppoHfD/32TmQldE7SWj76ij/6aMpccCPDEN7Yc9sMGaio/hfIg+M+lHCokY
Czx0uBZUOxyoHyzMmsuCVIaBiss3CN5Li3J5PBdidDQQHhA/VZEz9QRxHEC5WnqT
AAmmYMX7KzgRdJgBKUKlWVX9WcmzwT64LDdl+Yf9bjCUw/RApxxLf5Fnpkm60BlI
5biSJbeHCChep/jJsrr5DecFC05OkFW7VZBL8lzaMQaPG9sFznuPAc9ZtdhCK66k
b1AAKiqQzCWR3Wc3bv5pkMQC4m3WdJg=
-----END CERTIFICATE REQUEST-----
";

my $cakey = "
-----BEGIN PRIVATE KEY-----
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
KD1dN1sQ7VBSFd1xrZVLXNXoqGuTu3U=
-----END PRIVATE KEY-----
";

my $signed_request = "
-----BEGIN CERTIFICATE-----
MIIDVjCCAj4CCQCmjHfiwG5KRjANBgkqhkiG9w0BAQUFADBtMQswCQYDVQQGEwJT
RDENMAsGA1UECAwEc2RmZzENMAsGA1UEBwwEc2RmZzENMAsGA1UECgwEc2RmZzEN
MAsGA1UECwwEc2RmZzENMAsGA1UEAwwEc2RmZzETMBEGCSqGSIb3DQEJARYEc2Rm
ZzAeFw0xNDEyMTMxODQ4MjJaFw0xNTEyMDgxODQ4MjJaMG0xCzAJBgNVBAYTAkFT
MQ0wCwYDVQQIDARhc2RmMQ0wCwYDVQQHDARhc2RmMQ0wCwYDVQQKDARhc2RmMQ0w
CwYDVQQLDARhc2RmMQ0wCwYDVQQDDARhc2RmMRMwEQYJKoZIhvcNAQkBFgRhc2Rm
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1hxULig2ACqmcV/6pjEV
LntEjcQGSMpSK9ZYwaFgCFxksQWAseDN1HHmuPztZWIksMZpVeZm3zFE5e5mPEb5
B++m0Dpoxrr07MXGjLBO7GiKhB/Qov3SMkaiOSC5MLe1USwv9wSa/WU3vH2marmF
hE4fkFPc/UntPgAlnQyxA7NtbDUx9DDtlmrQMi3AlNkLDktsuD+H9fYQDFNEdM3m
kj+uZWdKsgxFDdNKmvkMBRXSsc1g7Uw4OB7ukv4ZtUzpLfq2rtN5yIncHvWoA+36
fQq/xr56k9S0uc+bOUcZqPCi+supWF77pYDvZ2sSLuv1ae42WrM7S7JF6O1kzDMz
XwIDAQABMA0GCSqGSIb3DQEBBQUAA4IBAQAKZM3TYTsirkePWaLi6SAsZUERIXRG
U6CDph8I/hXU890D/ALRLb7D/vxXVL3AfTbNtJrmNNFRV3JQCYR8OhG/rpyLZlhV
cwtcJt9bizoQSwLKajS3M612dYbxW+gX3d8R9Oeh80euyZp2d0ytc5jydoNuxwCX
1zeh2Rmqsal6Ia2IdlGbEDS5nXUi1c+pC9kehsrqm6dSmpX0x9Aiv3pKfYWaJ+Ya
NRrfbVubj2bVa++bzowbvBUzAn9W7198EHwmF1JzziBmun+xL3j3NaHyR4CIwQl3
IKenI3WkbOLTpkk7ubss834pGuzm3GwhQICQJRt7v9nAPm1PECr9Xkvu
-----END CERTIFICATE-----
";

print "creating pkcsreq from csr:", $/;
my $pkcsreq = test2::pkcsreq($key, $cacert, $req);
print $pkcsreq, $/;

print "print its transaction id", $/;
print test2::print_transid($pkcsreq), $/;

print "creating certreps:", $/;
print "PENDING:", $/;
print test2::certrep($cakey, $cacert, $pkcsreq, "FAILURE", "badRequest", $signed_request), $/;

print "FAILURE (badRequest for example):", $/;
print test2::certrep($cakey, $cacert, $pkcsreq, "FAILURE", "badRequest", $signed_request), $/;

print "SUCCESS (embedded cert does not correspond):", $/;
print test2::certrep($cakey, $cacert, $pkcsreq, "SUCCESS", NULL, $signed_request), $/;
